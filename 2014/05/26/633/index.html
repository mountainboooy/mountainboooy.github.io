<!DOCTYPE html><html lang="ja"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/><title>UIImageの画像の拡大・縮小・反転・回転</title><!-- javascript--><script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><script src="/js/main.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.0/normalize.css"><!-- Google Analytics--><!-- Global site tag (gtag.js)--><script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-41355170-3"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-41355170-3');
</script><!-- Open graph      --><meta name="description" content="UIImageの画像をリサイズ、回転、反転したい場合がある。こんなときにはQuartz 2D APIを使用する。Quartz 2D APIはCore Graphicsフレームワークの一部。">
<meta name="keywords" content="iOS,iPhone,Core Graphics,Objective-C,UIImage">
<meta property="og:type" content="article">
<meta property="og:title" content="UIImageの画像の拡大・縮小・反転・回転">
<meta property="og:url" content="https://github.com/mountainboooy.github.io/2014/05/26/633/index.html">
<meta property="og:site_name" content="mountainboooy">
<meta property="og:description" content="UIImageの画像をリサイズ、回転、反転したい場合がある。こんなときにはQuartz 2D APIを使用する。Quartz 2D APIはCore Graphicsフレームワークの一部。">
<meta property="og:locale" content="ja">
<meta property="og:image" content="https://i.gyazo.com/6e518c099fa06615f2bfef0b67927070.png">
<meta property="og:image" content="https://i.gyazo.com/d7bf020e7c3df8d52513b98b04ef15fc.png">
<meta property="og:image" content="https://i.gyazo.com/1a562d7b94eaca1239c90c97ee595ee2.png">
<meta property="og:image" content="https://i.gyazo.com/4d3ed305da3dd317671149711af9a6ea.png">
<meta property="og:image" content="https://i.gyazo.com/966db2881d3a34bbbaca746f23bd3546.png">
<meta property="og:updated_time" content="2018-10-28T04:11:38.834Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="UIImageの画像の拡大・縮小・反転・回転">
<meta name="twitter:description" content="UIImageの画像をリサイズ、回転、反転したい場合がある。こんなときにはQuartz 2D APIを使用する。Quartz 2D APIはCore Graphicsフレームワークの一部。">
<meta name="twitter:image" content="https://i.gyazo.com/6e518c099fa06615f2bfef0b67927070.png"><!--css--><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,600,600i,700,700i|Righteous|Roboto:400,400i,500,500i,700,700i"><link rel="stylesheet" href="/css/prism-xonokai.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head><body><div class="content"><div class="content-nav"><div class="sidenav"><div class="sidenav__header">m</div><ul class="unstyled-list sidenav__menu"><li class="sidenav__menu__item"><a class="unstyled-link" href="/">BLOG</a><div class="sidenav__menu__item__marker"></div></li><li class="sidenav__menu__item"><a class="unstyled-link" href="/about">PROFILE</a><div class="sidenav__menu__item__marker"></div></li><li class="sidenav__menu__item"><a class="unstyled-link" href="/works">WORKS</a><div class="sidenav__menu__item__marker"></div></li></ul><div class="sidenav__divider"></div><div class="profile"><div class="profile-thumb"><img src="https://i.gyazo.com/13a3f490a5a42074ffdb1722d8a38c3d.jpg"/></div><div class="profile-name align-center"><strong>TAKEU YOSHIHARA</strong></div><div class="profile-desc">京都のスタートアップで働くプロダクトデザイナーです。<a href="https://notainc.com">NotaInc.</a>という会社で<a href="https://gyazo.com">Gyazo</a>や<a href="https://scrapbox.io">Scrapbox</a>を作っています。
ものづくり、旅や山が大好きです。</div></div></div></div><div class="content-main"> <div class="post"><div class="container"><!-- date--><div class="created">2014.5.26</div><!--title--><h1 class="post-title">UIImageの画像の拡大・縮小・反転・回転</h1><!-- tags--><div class="post-tags"><a class="btn btn-tag post-tag" href="/tags/iOS/">iOS</a><a class="btn btn-tag post-tag" href="/tags/iPhone/">iPhone</a><a class="btn btn-tag post-tag" href="/tags/Core-Graphics/">Core Graphics</a><a class="btn btn-tag post-tag" href="/tags/Objective-C/">Objective-C</a><a class="btn btn-tag post-tag" href="/tags/UIImage/">UIImage</a></div><!-- article--><div class="article"><p>UIImageの画像をリサイズ、回転、反転したい場合がある。こんなときにはQuartz 2D APIを使用する。Quartz 2D APIはCore Graphicsフレームワークの一部。<a id="more"></a></p>
<p>CTM(Current Transformation Matrix）を使う。主に以下の3つ。</p>
<p><strong>CGContextTranslateCTM</strong> : 原点の平行移動<br><strong>CGContextRotateCTM </strong>: 原点を中心として座標系を回転<br><strong>CGContextScaleCTM</strong> : 原点を中心として座標系を拡大縮小</p>
<p>&nbsp;</p>
<p><span style="font-size: medium;"><strong>①とりあえずそのまま描画</strong></span></p>
<blockquote>
<pre class="brush: objc; gutter: false">- (UIImage*)drawImage

{

    UIImage *original_img = [UIImage imageNamed:@&quot;frog&quot;];


    UIGraphicsBeginImageContext(self.view.bounds.size);

    [original_img drawInRect:CGRectMake(0, 0, original_img.size.width, original_img.size.height)];

    UIImage *final_img = UIGraphicsGetImageFromCurrentImageContext();


    UIGraphicsEndImageContext();


    return final_img;

}</pre>

<p><a href="https://i.gyazo.com/6e518c099fa06615f2bfef0b67927070.png" target="_blank" rel="noopener"><img src="https://i.gyazo.com/6e518c099fa06615f2bfef0b67927070.png" alt="uiimage-07"></a><br>&nbsp;</p>
</blockquote>
<p><span style="font-size: medium;"><strong>②画像を平行移動させて描画する場合</strong></span><br>CGContextTranslateCTMで座標系を平行移動</p>
<blockquote>
<pre class="brush: objc; gutter: false">- (UIImage*)drawImageWithTranslateCTM

{

    UIImage *original_img = [UIImage imageNamed:@&quot;frog&quot;];


    UIGraphicsBeginImageContext(self.view.bounds.size);

    CGContextRef context = UIGraphicsGetCurrentContext();

    CGContextTranslateCTM(context, 100, 100);


    [original_img drawInRect:CGRectMake(0, 0, original_img.size.width, original_img.size.height)];

    UIImage *final_img = UIGraphicsGetImageFromCurrentImageContext();


    UIGraphicsEndImageContext();


    return final_img;

}</pre>

<p><a href="https://i.gyazo.com/d7bf020e7c3df8d52513b98b04ef15fc.png" target="_blank" rel="noopener"><img src="https://i.gyazo.com/d7bf020e7c3df8d52513b98b04ef15fc.png" alt="uiimage-08"></a><br>&nbsp;</p>
</blockquote>
<p><span style="font-size: medium;"><strong>③画像を回転させて描画する場合</strong></span><br>CGContextRotateCTMで座標系を回転</p>
<blockquote>
<pre class="brush: objc; gutter: false">- (UIImage*)drawImageWithRotateCTM

{

    UIImage *original_img = [UIImage imageNamed:@&quot;frog&quot;];


    UIGraphicsBeginImageContext(self.view.bounds.size);

    CGContextRef context = UIGraphicsGetCurrentContext();

    CGContextRotateCTM(context, 30 * M_PI/180);


    [original_img drawInRect:CGRectMake(0, 0, original_img.size.width, original_img.size.height)];

    UIImage *final_img = UIGraphicsGetImageFromCurrentImageContext();


    UIGraphicsEndImageContext();


    return final_img;

}</pre>

<p><a href="https://i.gyazo.com/1a562d7b94eaca1239c90c97ee595ee2.png" target="_blank" rel="noopener"><img src="https://i.gyazo.com/1a562d7b94eaca1239c90c97ee595ee2.png" alt="uiimage-09"></a><br>&nbsp;</p>
</blockquote>
<p><span style="font-size: medium;"><strong>④画像を縮小して描画する場合</strong></span><br>CGContextScaleCTMで座標系を縮小</p>
<blockquote>
<pre class="brush: objc; gutter: false">- (UIImage*)drawImageWithScaleCTM

{

    UIImage *original_img = [UIImage imageNamed:@&quot;frog&quot;];


    UIGraphicsBeginImageContext(self.view.bounds.size);

    CGContextRef context = UIGraphicsGetCurrentContext();

    CGContextScaleCTM(context, 0.5, 0.5);


    [original_img drawInRect:CGRectMake(0, 0, original_img.size.width, original_img.size.height)];

    UIImage *final_img = UIGraphicsGetImageFromCurrentImageContext();


    UIGraphicsEndImageContext();


    return final_img;

}</pre>

<p><a href="https://i.gyazo.com/4d3ed305da3dd317671149711af9a6ea.png" target="_blank" rel="noopener"><img src="https://i.gyazo.com/4d3ed305da3dd317671149711af9a6ea.png" alt="uiimage-10"></a><br>&nbsp;</p>
</blockquote>
<p><span style="font-size: medium;"><strong>④画像を反転して描画する場合</strong></span><br>CGContextScaleCTMで座標系をマイナス方向に拡大してCGContextTranslateCTMで平行移動</p>
<blockquote>
<pre class="brush: objc; gutter: false">- (UIImage*)drawImageInverted{

    UIImage *original_img = [UIImage imageNamed:@&quot;frog&quot;];


    UIGraphicsBeginImageContext(self.view.bounds.size);

    CGContextRef context = UIGraphicsGetCurrentContext();

    CGContextScaleCTM(context, -1, 1.0);

    CGContextTranslateCTM(context, -self.view.bounds.size.width, 0);


    [original_img drawInRect:CGRectMake(0, 0, original_img.size.width, original_img.size.height)];

    UIImage *final_img = UIGraphicsGetImageFromCurrentImageContext();


    UIGraphicsEndImageContext();


    return final_img;

}</pre>

<p><a href="https://i.gyazo.com/966db2881d3a34bbbaca746f23bd3546.png" target="_blank" rel="noopener"><img src="https://i.gyazo.com/966db2881d3a34bbbaca746f23bd3546.png" alt="uiimage-11"></a></p>
</blockquote>
</div><!-- related posts--><ul class="popular-posts"><li class="popular-posts-item"><div class="popular-posts-date">2014-07-12</div><div class="popular-posts-title"><h3><a href="/2014/07/12/697/" title="UIKeyboardの動きに合わせてviewをアニメーションさせる方法" rel="bookmark">UIKeyboardの動きに合わせてviewをアニメーションさせる方法</a></h3></div><div class="popular-posts-excerpt"><p><p>UIkeyboardの動きに合わせてビューも移動させたい。以下の動画ではピンクの部分が対象のビュー。</p></div></li><li class="popular-posts-item"><div class="popular-posts-date">2014-07-03</div><div class="popular-posts-title"><h3><a href="/2014/07/03/674/" title="【リリース】iPhoneアプリ 新幹線の空席案内" rel="bookmark">【リリース】iPhoneアプリ 新幹線の空席案内</a></h3></div><div class="popular-posts-excerpt"><p><p>新幹線を予約するのに、エクスプレス予約を使っているが恐ろしく使いにくい。せめて空席の検索だけでも簡単にできないかと思い、簡単なアプリを作ってみた。</p></div></li><li class="popular-posts-item"><div class="popular-posts-date">2014-12-07</div><div class="popular-posts-title"><h3><a href="/2014/12/07/1386/" title="Amazon Mobile Associates APIについてちょっと調べた" rel="bookmark">Amazon Mobile Associates APIについてちょっと調べた</a></h3></div><div class="popular-posts-excerpt"><p><p>モバイルアプリでAmazonの商品を扱うためのAPIについて調べてみた。アプリ内で購入まで完結させる機能もある。商品が売れればアプリの開発者は最大6%のマージンを受け取ることができる。この内容を見るとすごく魅力的。</p></div></li><li class="popular-posts-item"><div class="popular-posts-date">2015-04-25</div><div class="popular-posts-title"><h3><a href="/2015/04/25/1435/" title="Self Sizing Cells 選択時にセルの位置がずれてしまう問題を解決" rel="bookmark">Self Sizing Cells 選択時にセルの位置がずれてしまう問題を解決</a></h3></div><div class="popular-posts-excerpt"><p><h4 id="問題"><a href="#問題" class="headerlink" title="問題"></a>問題</h4><p>iOS8からはtableViewのセルの高さを動的に計算できるようになった。使ってみるとひとつ問題が発生。セルを選択して次画面にナビゲーション遷移する場合、選択直後にセルの位置がずれてしまう。</p></div></li><li class="popular-posts-item"><div class="popular-posts-date">2014-04-18</div><div class="popular-posts-title"><h3><a href="/2014/04/18/506/" title="TechCrunch主催のハッカソンに参加した" rel="bookmark">TechCrunch主催のハッカソンに参加した</a></h3></div><div class="popular-posts-excerpt"><p><p>グランフロント大阪のイノベーションハブにて催されたTechCrunch主催のハッカソン。テーマがIoTだったので興味を惹かれて参加。良いチームにも恵まれ色々と発見ができたイベントだったので内容を記録。</p></div></li><li class="popular-posts-item"><div class="popular-posts-date">2015-04-23</div><div class="popular-posts-title"><h3><a href="/2015/04/23/1424/" title="Xcode6でのローカライズの流れをメモ" rel="bookmark">Xcode6でのローカライズの流れをメモ</a></h3></div><div class="popular-posts-excerpt"><p><p>Xcode6でのローカライズの流れを調べた。ローカライズが必要なのは以下のもの。</p></div></li><li class="popular-posts-item"><div class="popular-posts-date">2013-12-04</div><div class="popular-posts-title"><h3><a href="/2013/12/04/345/" title="【リリース】手作り作品を購入・販売できるアプリ minne" rel="bookmark">【リリース】手作り作品を購入・販売できるアプリ minne</a></h3></div><div class="popular-posts-excerpt"><p><p>開発を担当したiOSアプリが最近リニューアルリリースされました。手作りの作品を購入・販売できるアプリ、minne。急激に盛り上がるモバイルのC2Cサービスの中でもハンドメイドに特化したアプリなので、商品のラインナップにはかなり特徴があります。ぜひDLしてみてください!</p></div></li><li class="popular-posts-item"><div class="popular-posts-date">2013-12-02</div><div class="popular-posts-title"><h3><a href="/2013/12/02/334/" title="無料天気予報API、OpenWeatherMapのためのiOSライブラリ JFOpenWeatherMapManager" rel="bookmark">無料天気予報API、OpenWeatherMapのためのiOSライブラリ JFOpenWeatherMapManager</a></h3></div><div class="popular-posts-excerpt"><p><p>そのうち役にたちそうなのでメモ。<br><a href="http://openweathermap.org/" title="OpenWeatherMap" target="_blank" rel="noopener">OpenWeatherMap</a>は開発者に無料で天気情報を提供するオンラインサービス。APIはJSONやxmlで取得可能。このAPIをiOSやMac OSX でより簡単に利用できるライブラ</p></div></li></ul></div><!-- footer--><footer>© 2018 Takeru Yoshihara </footer></div></div></div></body></html>